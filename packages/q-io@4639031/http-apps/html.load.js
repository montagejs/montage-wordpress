montageDefine("4639031","http-apps/html",{dependencies:["q"],factory:function(t,e,n){function l(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var a=t("q");e.HandleHtmlFragmentResponses=function(t,n){return n=n||e.handleHtmlFragmentResponse,function(e){return e.handleHtmlFragmentResponse=n,a.fcall(t,e).then(function(t){return t.htmlFragment?a.fcall(n,t):t})}},e.handleHtmlFragmentResponse=function(t){var e=t.htmlFragment;return delete t.htmlFragment,t.headers["content-type"]="text/html; charset=utf-8",t.body={forEach:function(n){n("<!doctype html>\n"),n("<html>\n"),n("    <head>\n"),void 0!==t.htmlTitle&&n("        <title>"+l(t.htmlTitle)+"</title>\n"),n("    </head>\n"),n("    <body>\n"),e.forEach(function(t){n("        "+t)}),n("    </body>\n"),n("</html>\n")}},t},e.escapeHtml=l}});